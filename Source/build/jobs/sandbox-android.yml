parameters:
  buildConfiguration: 'Debug'

jobs:
- job: sandboxAndroid
  displayName: Sandbox Android App
  condition: succeeded()
  pool:
    vmImage: $(MacImage)
    demands:
    - MSBuild
    - Xamarin.Android
    - JDK
    - AndroidSDK
  workspace:
    clean: all
  steps:
  - task: vs-publisher-473885.motz-mobile-buildtasks.android-manifest-version.android-manifest-version@0
    displayName: 'Bump Android Versions in AndroidManifest.xml'
    inputs:
      sourcePath: Sandbox/Xamarin/HelloWorld/HelloWorld/HelloWorld.Android/Properties/AndroidManifest.xml
      versionName: '7.2.$(Build.BuildId)'

  - template: ../steps/set-runtime.yml

  - template: ../steps/prepare-build.yml
    parameters:
      solution: Sandbox/Xamarin/HelloWorld/HelloWorld.sln

  - task: XamarinAndroid@1
    displayName: 'Build Xamarin.Android project HelloWorld.Android.csproj'
    inputs:
      projectFile: Sandbox/Xamarin/HelloWorld/HelloWorld/HelloWorld.Android/HelloWorld.Android.csproj
      outputDirectory: '$(Build.BinariesDirectory)/${{ parameters.buildConfiguration }}'
      configuration: ${{ parameters.buildConfiguration }}